<!-- question-management.component.html - FIXED VERSION -->
<div
  class="container-fluid d-flex flex-column align-items-center justify-content-start"
>
  <!-- Page Title -->
  <app-page-title translationKey="titles.QUESTION_MANAGEMENT" />

  <!-- Filter Bar with FIXED delete handler -->
  <app-feedback-filter-bar
    [showCreateButton]="isAdmin()"
    [showAssignButton]="isAdmin()"
    [showDeleteButton]="isAdmin()"
    [showExportButtons]="true"
    [showPrintButton]="true"
    [searchPlaceholder]="''"
    [filterModalTitle]="'QUESTION_MANAGEMENT.FILTER_TITLE'"
    (searchChange)="onSearchChange($event)"
    (createClick)="onCreateQuestion()"
    (assignClick)="onAssignQuestion()"
    (deleteClick)="onBulkDelete()"
    (filterClick)="openFilterModal()"
  ></app-feedback-filter-bar>

  <!-- Create Question Modal -->
  <app-create-question-modal
    *ngIf="showCreateModal"
    (create)="handleCreate($event)"
    [questionToEdit]="editingQuestion"
    (update)="handleUpdate($event)"
    (close)="closeCreateModal()"
  ></app-create-question-modal>

  <!-- Assign Question Modal with proper parameters -->
  <app-assign-question-modal
    *ngIf="showAssignModal"
    [questions]="assignableQuestions"
    [organizationId]="organizationId"
    [buildingId]="buildingId"
    [floorId]="floorId"
    (assigned)="onAssignConfirm($event)"
    (closed)="closeAssignModal()"
  ></app-assign-question-modal>

  <!-- Feedback Container with FIXED event handlers -->
  <div class="feedback-container">
    <app-question-container
      [feedbacks]="questions"
      [currentPage]="currentPage"
      [totalPages]="totalPages"
      [totalCount]="totalCount"
      [pageSize]="pageSize"
      (pageChanged)="onPageChange($event)"
      (pageSizeChanged)="onPageSizeChange($event)"
      (editFeedback)="onEditQuestion($event)"
      (deleteFeedback)="onDeleteQuestion($event)"
      (selectAllChanged)="onSelectAllChanged($event)"
      (questionSelectionChanged)="
        onQuestionSelectionChanged($event.questionId, $event.isSelected)
      "
    ></app-question-container>
  </div>

  <app-question-filter
    *ngIf="showFilterModal"
    (filterChange)="onFilterApplied($event)"
    (close)="closeFilterModal()"
  ></app-question-filter>

  <!-- Loading Indicator -->
  <div *ngIf="isLoading" class="loading-overlay">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>
</div>
